pipeline:
  identifier: Build_hashinyc_grafana_1746729656658
  name: Build grafana
  orgIdentifier: default
  projectIdentifier: CI_Pipeline
  properties:
    ci:
      codebase:
        build: <+input>
        connectorRef: account.Github_OAuth_1746652796717
        repoName: hashinyc/grafana
  stages:
    - parallel:
        - stage:
            identifier: build1
            name: build
            spec:
              caching:
                enabled: true
              cloneCodebase: true
              execution:
                steps:
                  - step:
                      identifier: gobuild
                      name: go_build
                      spec:
                        command: go build
                      timeout: ""
                      type: Run
                  - step:
                      identifier: gotestcoverage
                      name: go_test_coverage
                      spec:
                        command: go test -coverprofile=coverage.out ./...
                      timeout: ""
                      type: Run
                  - step:
                      identifier: gotestreport
                      name: go_test_report
                      spec:
                        command: "export GOBIN=/home/harness/go/bin\n\t\texport PATH=/home/harness/go/bin:$PATH\n\t\techo $PATH\n\t\tgo install github.com/jstemmer/go-junit-report/v2@latest\n\t\tgo test -v 2>&1 ./... | go-junit-report -set-exit-code > report.xml"
                        reports:
                          spec:
                            paths:
                              - /harness/report.xml
                          type: JUnit
                      timeout: ""
                      type: Run
                  - step:
                      identifier: installdependencies
                      name: install dependencies
                      spec:
                        command: npm install
                      timeout: ""
                      type: Run
                  - step:
                      identifier: test
                      name: test
                      spec:
                        command: npm run test
                      timeout: ""
                      type: Run
                  - step:
                      identifier: lint
                      name: lint
                      spec:
                        command: npm run lint
                      timeout: ""
                      type: Run
                  - step:
                      identifier: e2e
                      name: e2e
                      spec:
                        command: npm run e2e
                      timeout: ""
                      type: Run
                  - step:
                      identifier: build
                      name: build
                      spec:
                        command: npm run build
                      timeout: ""
                      type: Run
                  - step:
                      identifier: dockerbuild
                      name: docker_build
                      spec:
                        caching: true
                        connectorRef: <+input>
                        repo: hello/world
                        tags:
                          - latest
                      timeout: ""
                      type: BuildAndPushDockerRegistry
              platform:
                arch: Amd64
                os: Linux
              runtime:
                spec: {}
                type: Cloud
            type: CI
        - stage:
            name: Docker Build
            identifier: Docker_Build
            description: ""
            type: CI
            spec:
              cloneCodebase: true
              caching:
                enabled: true
                override: false
              platform:
                arch: Amd64
                os: Linux
              runtime:
                spec: {}
                type: Cloud
              execution:
                steps:
                  - step:
                      type: BuildAndPushDockerRegistry
                      name: BuildAndPushDockerRegistry_1
                      identifier: BuildAndPushDockerRegistry_1
                      spec:
                        connectorRef: account.DockerHub
                        repo: baiyun/grafana
                        tags:
                          - latest
                        caching: true
